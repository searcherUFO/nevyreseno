<!doctype html>
<html lang="cs">
<head>
    <meta charset="utf-8">
    <title>ETH Reliable Pro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #06090f; color: #c9d1d9; font-family: 'Consolas', monospace; }
        .card-custom { background-color: #0d1117; border: 1px solid #30363d; border-radius: 12px; padding: 25px; }
        textarea { background-color: #010409 !important; color: #58a6ff !important; border: 1px solid #30363d !important; height: 250px; font-size: 13px; }
        .eth-val { color: #238636; font-weight: bold; }
        .total-number { font-size: 2.5rem; color: #58a6ff; font-weight: bold; }
        .status-msg { color: #8b949e; font-size: 0.85rem; }
        .error-msg { color: #f85149; font-size: 0.8rem; }
    </style>
</head>
<body>

<div class="container py-5">
    <div class="card-custom shadow-lg">
        <div class="row align-items-center mb-4">
            <div class="col-md-7">
                <h2 class="fw-bold mb-0">ETH <span style="color:#58a6ff">PRO</span> Checker</h2>
                <div id="statusInfo" class="status-msg mt-1">Status: Připraven k analýze</div>
            </div>
            <div class="col-md-5 text-end border-start border-secondary py-2">
                <small class="text-muted fw-bold">CELKEM NAJDENO</small>
                <div class="total-number"><span id="totalEth">0.0000</span> <small class="fs-6 text-white">ETH</small></div>
            </div>
        </div>

        <div class="mb-4">
            <textarea id="addressInput" class="form-control" placeholder="Sem vlož ETH adresy (0x...)"></textarea>
        </div>

        <button id="runBtn" class="btn btn-primary btn-lg w-100 fw-bold" onclick="runReliable()">SPUSTIT KONTROLU (MAX STABILITA)</button>
        <div id="countdown" class="text-center mt-2 small text-warning"></div>
    </div>

    <div id="resultsArea" class="mt-4 d-none">
        <div class="card-custom p-0 overflow-hidden">
            <table class="table table-dark table-hover mb-0" style="font-size: 13px;">
                <thead>
                    <tr class="bg-dark">
                        <th class="ps-3 py-2 border-secondary text-muted">ADRESA</th>
                        <th class="text-end pe-3 py-2 border-secondary text-muted">ZŮSTATEK</th>
                    </tr>
                </thead>
                <tbody id="resultBody"></tbody>
            </table>
        </div>
    </div>
</div>

<script>
// Tvůj klíč
const API_KEY = "5U88UQ4T3UIC9C3MGUGN8V6G53WX214ME9";

async function runReliable() {
    const input = document.getElementById('addressInput').value;
    const addresses = input.split(/[\n,]+/)
        .map(a => a.trim().toLowerCase())
        .filter(a => a.startsWith('0x') && a.length === 42);

    if (addresses.length === 0) return alert("Vložte platné ETH adresy!");

    const btn = document.getElementById('runBtn');
    const status = document.getElementById('statusInfo');
    const totalDisp = document.getElementById('totalEth');
    const list = document.getElementById('resultBody');
    const resultsArea = document.getElementById('resultsArea');

    btn.disabled = true;
    resultsArea.classList.remove('d-none');
    list.innerHTML = '';
    let totalWei = BigInt(0);

    // NASTAVENÍ: Etherscan dovoluje 20 adres v jednom dotazu
    const BATCH_SIZE = 20;

    for (let i = 0; i < addresses.length; i += BATCH_SIZE) {
        const chunk = addresses.slice(i, i + BATCH_SIZE);
        status.innerText = `Skenuji: ${i + 1} - ${Math.min(i + BATCH_SIZE, addresses.length)} z ${addresses.length}`;

        const url = `https://api.etherscan.io/api?module=account&action=balancemulti&address=${chunk.join(',')}&tag=latest&apikey=${API_KEY}`;

        try {
            const response = await fetch(url);
            const data = await response.json();

            if (data.status === "1" && Array.isArray(data.result)) {
                let html = "";
                data.result.forEach(item => {
                    const wei = BigInt(item.balance);
                    totalWei += wei;
                    const eth = (Number(wei) / 1e18).toFixed(6);
                    
                    // Do tabulky přidáváme VŠE, abys viděl, že sken probíhá (šedé = 0 ETH)
                    const colorClass = wei > 0n ? "text-success fw-bold" : "text-muted";
                    
                    html += `<tr class="border-secondary">
                        <td class="ps-3 font-monospace small text-muted">${item.account}</td>
                        <td class="text-end pe-3 ${colorClass}">${eth} ETH</td>
                    </tr>`;
                });
                list.insertAdjacentHTML('afterbegin', html);
                totalDisp.innerText = (Number(totalWei) / 1e18).toFixed(4);
            } else {
                // Pokud nás server stopnul (Rate Limit)
                status.innerHTML = `<span class="error-msg">Zpomaluji... Server je přetížen. Čekám 3 sekundy.</span>`;
                await new Promise(r => setTimeout(r, 3000));
                i -= BATCH_SIZE; // Zkusit stejnou dávku znovu
                continue;
            }
        } catch (e) {
            status.innerHTML = `<span class="error-msg">Chyba sítě. Zkontroluj internet.</span>`;
        }

        // TADY JE TA DŮLEŽITÁ PAUZA: Etherscan Free dovoluje 5 dotazů za sekundu.
        // My budeme posílat jeden dotaz každou 1 vteřinu, aby to bylo 100% stabilní.
        await new Promise(r => setTimeout(r, 1000));
    }

    status.innerText = "DOKONČENO. Všechny adresy prověřeny.";
    btn.disabled = false;
}
</script>
</body>
</html>
