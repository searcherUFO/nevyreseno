<!doctype html>
<html lang="cs">
<head>
    <meta charset="utf-8">
    <title>ETH Verified Scanner</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #010409; color: #c9d1d9; font-family: 'Segoe UI', monospace; }
        .main-card { background: #0d1117; border: 1px solid #30363d; border-radius: 12px; padding: 25px; box-shadow: 0 10px 50px rgba(0,0,0,0.7); }
        textarea { background: #010409 !important; color: #58a6ff !important; border: 1px solid #30363d !important; height: 250px; font-size: 11px; }
        .stat-val { font-size: 2.2rem; font-weight: 800; color: #f7931a; }
        #totalEth { color: #3fb950; text-shadow: 0 0 10px rgba(63, 185, 80, 0.4); }
        .log-box { background: #000; height: 120px; overflow-y: scroll; padding: 10px; font-size: 11px; color: #8b949e; border: 1px solid #30363d; border-radius: 6px; border-left: 3px solid #f7931a; }
        .found-item { background: #1f2937; border-left: 4px solid #10b981; margin-bottom: 5px; padding: 10px; border-radius: 4px; animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { transform: translateX(20px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
    </style>
</head>
<body>

<div class="container py-4">
    <div class="main-card border-top border-4 border-primary">
        <div class="row align-items-center mb-4">
            <div class="col-md-5">
                <h2 class="fw-bold mb-0">ETH <span style="color:#58a6ff">VERIFIED</span> SCANNER</h2>
                <div class="small text-muted mt-1">Status: <span id="syncStatus" class="text-success">P≈ôipojen k Alchemy</span></div>
            </div>
            <div class="col-md-3 text-center border-start border-end border-secondary">
                <div class="small text-muted fw-bold">RYCHLOST</div>
                <div class="stat-val"><span id="speedNum">0</span> <small class="fs-6">/s</small></div>
            </div>
            <div class="col-md-4 text-end">
                <div class="small text-muted fw-bold">CELKEM ETH</div>
                <div id="totalEth" class="stat-val">0.000000</div>
            </div>
        </div>

        <textarea id="addressInput" class="form-control mb-3" placeholder="Vlo≈æte tis√≠ce adres (0x...)"></textarea>

        <button id="runBtn" class="btn btn-primary btn-lg w-100 fw-bold py-3 shadow" onclick="launchScanner()">SPUSTIT OVƒö≈òEN√ù SKEN (400/s)</button>
        
        <div id="log" class="log-box mt-3">Syst√©m p≈ôipraven k bleskov√© operaci...</div>
        <div id="foundList" class="mt-4"></div>
    </div>
</div>

<script>
const ALCHEMY_URL = "https://eth-mainnet.g.alchemy.com/v2/Aez99WycUrG8jncryndbA";
const BATCH_SIZE = 200; // Poƒçet adres v jednom bal√≠ku pro optim√°ln√≠ rychlost/stabilitu
let totalWei = BigInt(0);
let wakeLock = null;

function log(msg) {
    const l = document.getElementById('log');
    l.innerText += `\n[${new Date().toLocaleTimeString()}] ${msg}`;
    l.scrollTop = l.scrollHeight;
}

async function launchScanner() {
    const input = document.getElementById('addressInput').value;
    const addr = input.split(/[\n,]+/).map(a => a.trim().toLowerCase()).filter(a => a.startsWith('0x') && a.length === 42);
    
    if (!addr.length) return alert("Vlo≈æte adresy!");

    document.getElementById('runBtn').disabled = true;
    if ('wakeLock' in navigator) wakeLock = await navigator.wakeLock.request('screen');
    
    log(`üöÄ START: Provƒõ≈ôuji ${addr.length} adres.`);
    const startTime = performance.now();
    let index = 0;

    while (index < addr.length) {
        const chunk = addr.slice(index, index + BATCH_SIZE);
        const payload = chunk.map((a, i) => ({
            jsonrpc: "2.0", id: i, method: "eth_getBalance", params: [a, "latest"]
        }));

        try {
            // KL√çƒåOV√ù KROK: ƒåek√°me na 100% potvrzen√≠ odpovƒõdi
            const response = await fetch(ALCHEMY_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            const data = await response.json();

            // KONTROLA INTEGRITY: Pokud se poƒçet v√Ωsledk≈Ø nerovn√° poƒçtu odeslan√Ωch adres, bal√≠k opakujeme
            if (!Array.isArray(data) || data.length !== chunk.length) {
                log(`‚ö†Ô∏è Varov√°n√≠: Ne√∫pln√° data u indexu ${index}, opakuji bal√≠k...`, "#f7931a");
                await new Promise(r => setTimeout(r, 1000));
                continue; 
            }

            // Zpracov√°n√≠ √∫spƒõ≈°n√© a kompletn√≠ odpovƒõdi
            data.forEach((res, i) => {
                const hexVal = res.result || "0x0";
                const wei = BigInt(hexVal === "0x" ? "0x0" : hexVal);
                
                if (wei > 0n) {
                    const eth = (Number(wei) / 1e18).toFixed(6);
                    totalWei += wei;
                    document.getElementById('foundList').insertAdjacentHTML('afterbegin', `
                        <div class="found-item">
                            <div class="small text-muted font-monospace">${chunk[i]}</div>
                            <div class="h5 mb-0 text-success fw-bold">${eth} ETH</div>
                        </div>
                    `);
                    log(`üí∞ Z√ÅSAH: Adresa ${chunk[i].substring(0,10)}... m√° ${eth} ETH!`);
                }
            });

            // Update statistik
            index += chunk.length;
            const elapsed = (performance.now() - startTime) / 1000;
            document.getElementById('speedNum').innerText = Math.round(index / elapsed);
            document.getElementById('totalEth').innerText = (Number(totalWei) / 1e18).toFixed(6);

        } catch (e) {
            log(`‚ùå Chyba s√≠tƒõ na indexu ${index}. ƒåek√°m 2s...`);
            await new Promise(r => setTimeout(r, 2000));
            continue; // Zkus√≠ stejn√Ω bal√≠k znovu
        }

        // Mal√Ω limit pro udr≈æen√≠ UI plynul√©ho
        if (index % 1000 === 0) await new Promise(r => setTimeout(r, 50));
    }

    log("‚úÖ HOTOVO. V≈°echny adresy byly s jistotou provƒõ≈ôeny.");
    document.getElementById('runBtn').disabled = false;
    if (wakeLock) await wakeLock.release();
}
</script>
</body>
</html>
